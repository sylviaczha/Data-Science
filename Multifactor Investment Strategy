import pandas as pd
import numpy as np
import tushare as ts
import os 
import datetime 
from datetime import datetime as dt
from datetime import timedelta
import time
import xlrd

ts.set_token('your token here')
api = ts.pro_api()

sharecode = pd.read_csv('your file path')

def fetchhistoricaldata():
    for i in range(300):
        filename = 'your path file'.format(sharecode['code'][i])
        data = ts.get_hist_data(code=stock['code'][i])
        if os.path.exists(filename):
            data.to_csv(filename, mode='a')
        else:
            data.to_csv(filename, mode='a')
            
fetchhistoricaldata()            


def fetchfina_indicator():
    for i in range(300):
        filename = 'your file path'.format(sharecode['sharecode'][i])
        data=api.fina_indicator(ts_code=sharecode['sharecode'][i],end_date='2019-12-31')
        if os.path.exists(filename):
            data.to_csv(filename, mode='a')
        else:
            data.to_csv(filename, mode='a')

fetchfina_indicator()

def fetch_balancesheet():
    for i in range(300):
        filename = 'you file path'.format(sharecode['sharecode'][i])
        data=api.balancesheet(ts_code=sharecode['sharecode'][i],end_date='2019-12-31')
        if os.path.exists(filename):
            data.to_csv(filename, mode='a')
        else:
            data.to_csv(filename, mode='a')
            
fetch_balancesheet()




 
 
 
 
